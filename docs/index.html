<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Documantation of shin1koda/dmf &mdash; dmf 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=f2a433a1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            dmf
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Documantation of shin1koda/dmf</a><ul>
<li><a class="reference internal" href="#dmf.DirectMaxFlux"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux</span></code></a><ul>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.images"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.images</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.coefs"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.coefs</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.angs"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.angs</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.energies"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.energies</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.e0"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.e0</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.forces"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.forces</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.history"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.history</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.natoms"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.natoms</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.nbasis"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.nbasis</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.ipopt_options"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.ipopt_options</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.remove_rotation_and_translation"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.remove_rotation_and_translation</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.nsegs"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.nsegs</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.dspl"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.dspl</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.t_eval"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.t_eval</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.w_eval"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.w_eval</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.n_vel"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.n_vel</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.n_trans"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.n_trans</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.n_rot"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.n_rot</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.eps_vel"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.eps_vel</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.eps_rot"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.eps_rot</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.beta"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.beta</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.nmove"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.nmove</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.update_teval"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.update_teval</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.params_t_update"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.params_t_update</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.get_positions"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.get_positions()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.set_positions"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.set_positions()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.get_forces"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.get_forces()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.interpolate_energies"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.interpolate_energies()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.get_x"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.get_x()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.set_x"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.set_x()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.solve"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.solve()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.objective"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.objective()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.gradient"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.gradient()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.constraints"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.constraints()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.jacobian"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.jacobian()</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.intermediate"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.intermediate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History</span></code></a><ul>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.forces"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.forces</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.energies"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.energies</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.coefs"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.coefs</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.angs"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.angs</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.t_eval"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.t_eval</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.tmax"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.tmax</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.images_tmax"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.images_tmax</span></code></a></li>
<li><a class="reference internal" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.duals"><code class="docutils literal notranslate"><span class="pre">DirectMaxFlux.History.duals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">dmf</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Documantation of shin1koda/dmf</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="documantation-of-shin1koda-dmf">
<h1>Documantation of shin1koda/dmf<a class="headerlink" href="#documantation-of-shin1koda-dmf" title="Link to this heading"></a></h1>
<p>dmf.py is a Python module of the direct MaxFlux method. When you use this module in your research, please cite [1] Shin-ichi Koda and Shinji Saito, JCTC (2024). doi.</p>
<div class="toctree-wrapper compound">
</div>
<dl class="py class">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dmf.</span></span><span class="sig-name descname"><span class="pre">DirectMaxFlux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsegs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dspl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_rotation_and_translation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_vel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_vel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_teval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_t_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'de':</span> <span class="pre">0.15,</span> <span class="pre">'dia':</span> <span class="pre">1.0,</span> <span class="pre">'dib':</span> <span class="pre">0.2,</span> <span class="pre">'epsb':</span> <span class="pre">0.02,</span> <span class="pre">'max_alpha0':</span> <span class="pre">0.1,</span> <span class="pre">'mua':</span> <span class="pre">5.0,</span> <span class="pre">'mub':</span> <span class="pre">5.0}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux" title="Link to this definition"></a></dt>
<dd><p>Class for the direct MaxFlux method.</p>
<p>This class defines the variational problem of the direct MaxFlux method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_images</strong> (<em>list</em><em> of </em><em>ase.Atoms</em>) – Reference images for generating an initial path. If coefs is not present, coefs of the initial path is generated by a linear interpolation with ref_images. If coefs is present, only ref_images[0] and ref_images[-1] are used as the endpoints of the path.</p></li>
<li><p><strong>coefs</strong> (<em>numpy.ndarray shape</em><em> (</em><em>nbasis</em><em>,</em><em>natoms</em><em>,</em><em>3</em><em>)</em><em>,</em><em>optional</em>) – Coefficients of basis functions. If coefs is present, the interpolation with ref_images is skipped, and coefs is stored as it is. Default is None.</p></li>
<li><p><strong>nsegs</strong> (<em>int</em><em>,</em><em>optional</em>) – Determines the number of B-spline functions. See Ref. 1 for details. Default is 4.</p></li>
<li><p><strong>dspl</strong> (<em>int</em><em>,</em><em>optional</em>) – Degree of B-spline functions. Default is 3.</p></li>
<li><p><strong>remove_rotation_and_translation</strong> (<em>bool</em><em>,</em><em>optional</em>) – Remove redundancy regarding rotaional and translational symmetry. Default is True.</p></li>
<li><p><strong>mass_weighted</strong> (<em>bool</em><em>,</em><em>optional</em>) – Use mass-weighted coordinates. False is recommended for a rapid convergence. Default is False.</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>,</em><em>optional</em>) – Calculate forces of images in parallel. Both Threading and MPI are supported. Default is False. Usage is basically the same as the NEB method in ASE. See <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/neb.html#parallelization-over-images">ASE’s document</a>.</p></li>
<li><p><strong>world</strong> (<em>MPI world object</em><em>,</em><em>optional</em>) – If not present, ase.parallel.world is used. Default is None.</p></li>
<li><p><strong>t_eval</strong> (<em>numpy.ndarray shape</em><em> (</em><em>nmove+2</em><em>)</em><em>,</em><em>optional</em>) – Initial energy evaluation points. If not present or update_teval is True, an equally distributed t_eval is used. Default is None.</p></li>
<li><p><strong>w_eval</strong> (<em>numpy.ndarray shape</em><em> (</em><em>nmove+2</em><em>)</em><em>,</em><em>optional</em>) – Weights of the numerical integuration of the objective function. If not present, w_eval is determined by the trapezoidal formula. Default is None.</p></li>
<li><p><strong>n_vel</strong> (<em>int</em><em>,</em><em>optional</em>) – Determines the number of velocity constraints. See Ref. 1 for details. If not present, n_vel is 4*nsegs. Default is None.</p></li>
<li><p><strong>n_trans</strong> (<em>int</em><em>,</em><em>optional</em>) – Determines the number of translational constraints. See Ref. 1 for details. If not present, n_trans is 2*nsegs. Default is None.</p></li>
<li><p><strong>n_rot</strong> (<em>int</em><em>,</em><em>optional</em>) – Determines the number of rotational constraints. See Ref. 1 for details. If not present, n_rot is 2*nsegs. Default is None.</p></li>
<li><p><strong>eps_vel</strong> (<em>float</em><em>,</em><em>optional</em>) – Parameter for loosening velocity constraints. See Ref. 1 for details. Default is 0.01.</p></li>
<li><p><strong>eps_rot</strong> (<em>float</em><em>,</em><em>optional</em>) – Parameter for loosening rotational constraints. See Ref. 1 for details. Default is 0.01.</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>,</em><em>optional</em>) – Reciprocal temperature of the direct MaxFlux method. Default is 10 [/eV].</p></li>
<li><p><strong>nmove</strong> (<em>int</em><em>,</em><em>optional</em>) – The number of movable energy evaluation points (images). Default is 5.</p></li>
<li><p><strong>update_teval</strong> (<em>bool</em><em>,</em><em>optional</em>) – Update t_eval at each iteration. Default is False.</p></li>
<li><p><strong>params_t_update</strong> (<em>dict</em><em>,</em><em>optional</em>) – Parameters for t_eval updating. See Ref. 1 for details.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.images">
<span class="sig-name descname"><span class="pre">images</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.images" title="Link to this definition"></a></dt>
<dd><p>nmove+2 images at t_eval.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of ase.Atoms</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.coefs">
<span class="sig-name descname"><span class="pre">coefs</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.coefs" title="Link to this definition"></a></dt>
<dd><p>Coefficients of B-spline functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray shape (nbasis,natoms,3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.angs">
<span class="sig-name descname"><span class="pre">angs</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.angs" title="Link to this definition"></a></dt>
<dd><p>Euler angles of images[-1], which is used when remove_rotation_and_translation is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray shape (3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.energies">
<span class="sig-name descname"><span class="pre">energies</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.energies" title="Link to this definition"></a></dt>
<dd><p>Energies of all images, which are shifted by e0, are stored after calling get_forces().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray shape (nmove+2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.e0">
<span class="sig-name descname"><span class="pre">e0</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.e0" title="Link to this definition"></a></dt>
<dd><p>min(E(images[0]),E(images[-1]))</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.forces">
<span class="sig-name descname"><span class="pre">forces</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.forces" title="Link to this definition"></a></dt>
<dd><p>Forces of each image are stored after calling get_forces().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray shape (nmove+2,natoms,3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.history">
<span class="sig-name descname"><span class="pre">history</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.history" title="Link to this definition"></a></dt>
<dd><p>Object that stores histories of some properties. See History object below.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>History object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.natoms">
<span class="sig-name descname"><span class="pre">natoms</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.natoms" title="Link to this definition"></a></dt>
<dd><p>The number of atoms in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.nbasis">
<span class="sig-name descname"><span class="pre">nbasis</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.nbasis" title="Link to this definition"></a></dt>
<dd><p>The number of the B-spline functions. nbasis = nsegs + dspl.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.ipopt_options">
<span class="sig-name descname"><span class="pre">ipopt_options</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.ipopt_options" title="Link to this definition"></a></dt>
<dd><p>Non-default options of IPOPT. On initialization, {‘tol’:1.0, ‘dual_inf_tol’:0.04, ‘constr_viol_tol’:0.01, ‘compl_inf_tol’:0.01, ‘nlp_scaling_method’:’user-scaling’, ‘obj_scaling_factor’:0.1, ‘limited_memory_initialization’:’constant’, ‘limited_memory_init_val’:2.5, ‘accept_every_trial_step’:’yes’, ‘output_file’:’dmf.out’,} is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.remove_rotation_and_translation">
<span class="sig-name descname"><span class="pre">remove_rotation_and_translation</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.remove_rotation_and_translation" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.nsegs">
<span class="sig-name descname"><span class="pre">nsegs</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.nsegs" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.dspl">
<span class="sig-name descname"><span class="pre">dspl</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.dspl" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.t_eval">
<span class="sig-name descname"><span class="pre">t_eval</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.t_eval" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.w_eval">
<span class="sig-name descname"><span class="pre">w_eval</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.w_eval" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.n_vel">
<span class="sig-name descname"><span class="pre">n_vel</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.n_vel" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.n_trans">
<span class="sig-name descname"><span class="pre">n_trans</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.n_trans" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.n_rot">
<span class="sig-name descname"><span class="pre">n_rot</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.n_rot" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.eps_vel">
<span class="sig-name descname"><span class="pre">eps_vel</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.eps_vel" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.eps_rot">
<span class="sig-name descname"><span class="pre">eps_rot</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.eps_rot" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.beta">
<span class="sig-name descname"><span class="pre">beta</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.beta" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.nmove">
<span class="sig-name descname"><span class="pre">nmove</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.nmove" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.update_teval">
<span class="sig-name descname"><span class="pre">update_teval</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.update_teval" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.params_t_update">
<span class="sig-name descname"><span class="pre">params_t_update</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.params_t_update" title="Link to this definition"></a></dt>
<dd><p>Same as the above parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">History</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History" title="Link to this definition"></a></dt>
<dd><p>Object storing histories of properties listed below.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.forces">
<span class="sig-name descname"><span class="pre">forces</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.forces" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of numpy.ndarray shape (nmove+2,natoms,3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.energies">
<span class="sig-name descname"><span class="pre">energies</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.energies" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of numpy.ndarray shape (nmove+2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.coefs">
<span class="sig-name descname"><span class="pre">coefs</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.coefs" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of numpy.ndarray shape (nbasis,natoms,3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.angs">
<span class="sig-name descname"><span class="pre">angs</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.angs" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of numpy.ndarray shape (3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.t_eval">
<span class="sig-name descname"><span class="pre">t_eval</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.t_eval" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of numpy.ndarray shape (nmove+2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.tmax">
<span class="sig-name descname"><span class="pre">tmax</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.tmax" title="Link to this definition"></a></dt>
<dd><p>History of tmax. tmax is the highest energy point of the interpoated energy along the path. See Ref. 1 for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.images_tmax">
<span class="sig-name descname"><span class="pre">images_tmax</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.images_tmax" title="Link to this definition"></a></dt>
<dd><p>History of the image at t=tmax, an approximation of TS.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of ase.Atoms</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.DirectMaxFlux.History.duals">
<span class="sig-name descname"><span class="pre">duals</span></span><a class="headerlink" href="#dmf.DirectMaxFlux.DirectMaxFlux.History.duals" title="Link to this definition"></a></dt>
<dd><p>History of the scaled dual infeasibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.get_positions">
<span class="sig-name descname"><span class="pre">get_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.get_positions" title="Link to this definition"></a></dt>
<dd><p>Get all positions of images at t or their derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D numpy.ndarray</em><em>, </em><em>optional</em>) – All positions of images at t or their derivatives are returned. If not present, t_eval is used. Default is None.</p></li>
<li><p><strong>P</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – Return of _get_basis_values(t). See source code. Default is None. If both t and P are present, P is used in priority.</p></li>
<li><p><strong>nu</strong> (<em>int</em><em>, </em><em>optional</em>) – Degree of derivative with respect to t. nu must be 0, 1, or 2. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.ndarray shape</strong> (<em>nimages,natoms,3</em>) – Positions or their nu-th derivative at t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.set_positions">
<span class="sig-name descname"><span class="pre">set_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.set_positions" title="Link to this definition"></a></dt>
<dd><p>Set positions of all images in self.images. These positions are determined by coefs and angs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coefs</strong> (<em>numpy.ndarray shape</em><em> (</em><em>nbasis</em><em>,</em><em>natoms</em><em>,</em><em>3</em><em>)</em><em>, </em><em>optional</em>) – If not present, self.coefs is used. Default is None.</p></li>
<li><p><strong>angs</strong> (<em>numpy.ndarray shape</em><em> (</em><em>3</em><em>)</em><em>, </em><em>optional</em>) – If not present, self.angs is used. Default is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.get_forces">
<span class="sig-name descname"><span class="pre">get_forces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.get_forces" title="Link to this definition"></a></dt>
<dd><p>Get forces of all images in self.images. After calling this method, forces and energies are stored in self.forces and self.energies, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>numpy.ndarray shape</strong> (<em>nimages,natoms,3</em>) – Forces of all images in self.images.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.interpolate_energies">
<span class="sig-name descname"><span class="pre">interpolate_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.interpolate_energies" title="Link to this definition"></a></dt>
<dd><p>Interpolate the enegy along the path. See Ref. 1 for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optional</strong><strong>)</strong> (<em>t_eval</em><em> (</em><em>numpy.ndarray shape</em><em> (</em><em>:</em><em> )</em><em>,</em>) – Points where energies and forces were evaluated. If not present, self.t_eval is used. Default is None.</p></li>
<li><p><strong>energies</strong> (<em>numpy.ndarray shape</em><em> (</em><em>len</em><em>(</em><em>t_eval</em><em>)</em><em>)</em><em>, </em><em>optional</em>) – Energies evaluated at t_eval. If not present, self.energies is used. Default is None.</p></li>
<li><p><strong>forces</strong> (<em>numpy.ndarray shape</em><em> (</em><em>len</em><em>(</em><em>t_eval</em><em>)</em><em>,</em><em>natoms</em><em>,</em><em>3</em><em>)</em><em>, </em><em>optional</em>) – Forces evaluated at t_eval. If not present, self.forces is used. Default is None.</p></li>
<li><p><strong>coefs</strong> (<em>numpy.ndarray shape</em><em> (</em><em>nbasis</em><em>,</em><em>natoms</em><em>,</em><em>3</em><em>)</em><em>, </em><em>optional</em>) – Coefficients of B-spline functions. If not present, self.coefs is used. Default is None.</p></li>
<li><p><strong>delta_e</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – If present, return points that satisfy <span class="math notranslate nohighlight">\(\tilde{E}(t) = E_{\max} - \text{delta_e}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>polys</strong> (<em>numpy.ndarray shape (len(t_eval)-1,4)</em>) – Coefficients of piecewise cubic polynomial.</p></li>
<li><p><strong>t_max</strong> (<em>float</em>) – Maximum point of <span class="math notranslate nohighlight">\(\tilde{E}(t)\)</span>.</p></li>
<li><p><strong>e_max</strong> (<em>float</em>) – Maximum value of <span class="math notranslate nohighlight">\(\tilde{E}(t)\)</span>.</p></li>
<li><p><strong>t_de</strong> (<em>list of float</em>) – Points that satisfy <span class="math notranslate nohighlight">\(\tilde{E}(t) = E_{\max} - \text{delta_e}\)</span>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.get_x">
<span class="sig-name descname"><span class="pre">get_x</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.get_x" title="Link to this definition"></a></dt>
<dd><p>Get variables of the variational problem in a 1D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>1D numpy.ndarray</em>) – self.coefs[1:-1].flatten(). If remove_rotation_and_translation is True, self.angs is appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.set_x">
<span class="sig-name descname"><span class="pre">set_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.set_x" title="Link to this definition"></a></dt>
<dd><p>Set self.coefs and self.angs from x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>1D numpy.ndarray</em>) – Variables of the variational problem in a 1D array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tight'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.solve" title="Link to this definition"></a></dt>
<dd><p>Solve the variational problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tol</strong> (<em>float</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Change IOPOT option dual_inf_tol. If tol is float, dual_inf_tol is set to tol. If tol is either ‘tight’, ‘middle’, or ‘loose’ (keywords used in Ref. 1), dual_inf_tol is set to 0.04, 0.1, or 0.2, respectively. Default is ‘tight’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.objective">
<span class="sig-name descname"><span class="pre">objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.objective" title="Link to this definition"></a></dt>
<dd><p>Objective function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>1D numpy.ndarray</em>) – Variables of the variational problem in a 1D array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float</strong> – Objective function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.gradient">
<span class="sig-name descname"><span class="pre">gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.gradient" title="Link to this definition"></a></dt>
<dd><p>Gradient of the objective function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>1D numpy.ndarray</em>) – Variables of the variational problem in a 1D array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.ndarray shape</strong> (<em>len(x)</em>) – Gradient of the objective function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.constraints">
<span class="sig-name descname"><span class="pre">constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.constraints" title="Link to this definition"></a></dt>
<dd><p>Constraints.
:param x: Variables of the variational problem in a 1D array.
:type x: 1D numpy.ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>numpy.ndarray shape</strong> (<em># of constraints</em>) – Constraints.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.jacobian">
<span class="sig-name descname"><span class="pre">jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.jacobian" title="Link to this definition"></a></dt>
<dd><p>Jacobian of the constraints.
:param x: Variables of the variational problem in a 1D array.
:type x: 1D numpy.ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>numpy.ndarray shape</strong> (<em># of constraints,len(x)</em>) – Jacobian of the constraints.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dmf.DirectMaxFlux.intermediate">
<span class="sig-name descname"><span class="pre">intermediate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alg_mod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_pr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_du</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_du</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_pr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_trials</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dmf.DirectMaxFlux.intermediate" title="Link to this definition"></a></dt>
<dd><p>Method called at the end of each iteration. Updating of t_eval is defined in this method.</p>
</dd></dl>

</dd></dl>

</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Shin-ichi Koda.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>